

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Simulators Package &mdash; IntelliSwarm 1.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=8d563738"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Utilities Package" href="swarmsim.Utils.html" />
    <link rel="prev" title="Visualization &amp; Rendering" href="swarmsim.Renderers.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #2980B9" >

          
          
          <a href="index.html" class="icon icon-home">
            IntelliSwarm
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="installation.html#requirements">Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#core-dependencies">Core Dependencies</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#optional-dependencies">Optional Dependencies</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#installation-methods">Installation Methods</a><ul>
<li class="toctree-l3"><a class="reference internal" href="installation.html#method-1-install-from-source-recommended">Method 1: Install from Source (Recommended)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#verification">Verification</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#next-steps">Next Steps</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#support">Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#contributing">Contributing</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quick Start Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="quickstart.html#your-first-simulation">Your First Simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="quickstart.html#core-concepts">Core Concepts</a></li>
<li class="toctree-l2"><a class="reference internal" href="quickstart.html#configuration-files">Configuration Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="quickstart.html#running-simulations-using-gui">Running Simulations using GUI</a></li>
<li class="toctree-l2"><a class="reference internal" href="quickstart.html#next-steps">Next Steps</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Documentation</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="swarmsim.html">IntelliSwarm Package</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="swarmsim.html#swarmsim-a-large-scale-multi-agent-simulator">SwarmSim: A Large-Scale Multi-Agent Simulator</a><ul>
<li class="toctree-l3"><a class="reference internal" href="swarmsim.html#key-features">Key Features</a></li>
<li class="toctree-l3"><a class="reference internal" href="swarmsim.html#main-components">Main Components</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="swarmsim.html#package-overview">Package Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="swarmsim.html#architecture">Architecture</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="swarmsim.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="swarmsim.Controllers.html">Controllers Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="swarmsim.Controllers.html#controllers-module">Controllers Module</a></li>
<li class="toctree-l4"><a class="reference internal" href="swarmsim.Controllers.html#package-overview">Package Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="swarmsim.Controllers.html#core-modules">Core Modules</a></li>
<li class="toctree-l4"><a class="reference internal" href="swarmsim.Controllers.html#usage-examples">Usage Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="swarmsim.Controllers.html#control-architecture">Control Architecture</a></li>
<li class="toctree-l4"><a class="reference internal" href="swarmsim.Controllers.html#performance-considerations">Performance Considerations</a></li>
<li class="toctree-l4"><a class="reference internal" href="swarmsim.Controllers.html#best-practices">Best Practices</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="swarmsim.Environments.html">Environments Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="swarmsim.Environments.html#environments-module">Environments Module</a></li>
<li class="toctree-l4"><a class="reference internal" href="swarmsim.Environments.html#swarmsim.Environments.Environment"><code class="docutils literal notranslate"><span class="pre">Environment</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="swarmsim.Environments.html#swarmsim.Environments.EmptyEnvironment"><code class="docutils literal notranslate"><span class="pre">EmptyEnvironment</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="swarmsim.Environments.html#swarmsim.Environments.ShepherdingEnvironment"><code class="docutils literal notranslate"><span class="pre">ShepherdingEnvironment</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="swarmsim.Environments.html#package-overview">Package Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="swarmsim.Environments.html#core-modules">Core Modules</a></li>
<li class="toctree-l4"><a class="reference internal" href="swarmsim.Environments.html#usage-examples">Usage Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="swarmsim.Environments.html#best-practices">Best Practices</a></li>
<li class="toctree-l4"><a class="reference internal" href="swarmsim.Environments.html#id1">Shepherding Environment</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="swarmsim.Integrators.html">Numerical Integrators</a></li>
<li class="toctree-l3"><a class="reference internal" href="swarmsim.Integrators.html#overview">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="swarmsim.Integrators.html#key-features">Key Features</a></li>
<li class="toctree-l3"><a class="reference internal" href="swarmsim.Integrators.html#module-swarmsim.Integrators">Module Reference</a><ul>
<li class="toctree-l4"><a class="reference internal" href="swarmsim.Integrators.html#integrators-module">Integrators Module</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="swarmsim.Integrators.html#base-integrator-interface">Base Integrator Interface</a><ul>
<li class="toctree-l4"><a class="reference internal" href="swarmsim.Integrators.html#swarmsim.Integrators.base_integrator.Integrator"><code class="docutils literal notranslate"><span class="pre">Integrator</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="swarmsim.Integrators.html#euler-maruyama-integrator">Euler-Maruyama Integrator</a><ul>
<li class="toctree-l4"><a class="reference internal" href="swarmsim.Integrators.html#swarmsim.Integrators.euler_maruyama.EulerMaruyamaIntegrator"><code class="docutils literal notranslate"><span class="pre">EulerMaruyamaIntegrator</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="swarmsim.Integrators.html#troubleshooting">Troubleshooting</a><ul>
<li class="toctree-l4"><a class="reference internal" href="swarmsim.Integrators.html#common-integration-issues">Common Integration Issues</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="swarmsim.Integrators.html#see-also">See Also</a></li>
<li class="toctree-l3"><a class="reference internal" href="swarmsim.Interactions.html">Interactions Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="swarmsim.Interactions.html#interactions-module">Interactions Module</a></li>
<li class="toctree-l4"><a class="reference internal" href="swarmsim.Interactions.html#swarmsim.Interactions.Interaction"><code class="docutils literal notranslate"><span class="pre">Interaction</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="swarmsim.Interactions.html#swarmsim.Interactions.HarmonicRepulsion"><code class="docutils literal notranslate"><span class="pre">HarmonicRepulsion</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="swarmsim.Interactions.html#swarmsim.Interactions.PowerLawRepulsion"><code class="docutils literal notranslate"><span class="pre">PowerLawRepulsion</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="swarmsim.Interactions.html#swarmsim.Interactions.PowerLawInteraction"><code class="docutils literal notranslate"><span class="pre">PowerLawInteraction</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="swarmsim.Interactions.html#swarmsim.Interactions.LennardJones"><code class="docutils literal notranslate"><span class="pre">LennardJones</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="swarmsim.Interactions.html#package-overview">Package Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="swarmsim.Interactions.html#core-modules">Core Modules</a></li>
<li class="toctree-l4"><a class="reference internal" href="swarmsim.Interactions.html#best-practices">Best Practices</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="swarmsim.Loggers.html">Data Loggers</a></li>
<li class="toctree-l3"><a class="reference internal" href="swarmsim.Loggers.html#overview">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="swarmsim.Loggers.html#key-features">Key Features</a></li>
<li class="toctree-l3"><a class="reference internal" href="swarmsim.Loggers.html#module-swarmsim.Loggers">Module Reference</a></li>
<li class="toctree-l3"><a class="reference internal" href="swarmsim.Loggers.html#base-logger-interface">Base Logger Interface</a><ul>
<li class="toctree-l4"><a class="reference internal" href="swarmsim.Loggers.html#swarmsim.Loggers.base_logger.BaseLogger"><code class="docutils literal notranslate"><span class="pre">BaseLogger</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="swarmsim.Loggers.html#standard-logger-implementation">Standard Logger Implementation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="swarmsim.Loggers.html#swarmsim.Loggers.logger.Logger"><code class="docutils literal notranslate"><span class="pre">Logger</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="swarmsim.Loggers.html#features">Features</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="swarmsim.Loggers.html#position-logger">Position Logger</a><ul>
<li class="toctree-l4"><a class="reference internal" href="swarmsim.Loggers.html#swarmsim.Loggers.position_logger.PositionLogger"><code class="docutils literal notranslate"><span class="pre">PositionLogger</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="swarmsim.Loggers.html#capabilities">Capabilities</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="swarmsim.Loggers.html#shepherding-logger">Shepherding Logger</a><ul>
<li class="toctree-l4"><a class="reference internal" href="swarmsim.Loggers.html#swarmsim.Loggers.shepherding_logger.ShepherdingLogger"><code class="docutils literal notranslate"><span class="pre">ShepherdingLogger</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="swarmsim.Loggers.html#specialized-features">Specialized Features</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="swarmsim.Loggers.html#see-also">See Also</a></li>
<li class="toctree-l3"><a class="reference internal" href="swarmsim.Populations.html">Populations Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="swarmsim.Populations.html#population-module">Population Module</a></li>
<li class="toctree-l4"><a class="reference internal" href="swarmsim.Populations.html#package-overview">Package Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="swarmsim.Populations.html#core-modules">Core Modules</a></li>
<li class="toctree-l4"><a class="reference internal" href="swarmsim.Populations.html#usage-examples">Usage Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="swarmsim.Populations.html#performance-optimization">Performance Optimization</a></li>
<li class="toctree-l4"><a class="reference internal" href="swarmsim.Populations.html#model-selection-guide">Model Selection Guide</a></li>
<li class="toctree-l4"><a class="reference internal" href="swarmsim.Populations.html#best-practices">Best Practices</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="swarmsim.Renderers.html">Visualization &amp; Rendering</a></li>
<li class="toctree-l3"><a class="reference internal" href="swarmsim.Renderers.html#overview">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="swarmsim.Renderers.html#key-features">Key Features</a></li>
<li class="toctree-l3"><a class="reference internal" href="swarmsim.Renderers.html#module-swarmsim.Renderers">Module Reference</a><ul>
<li class="toctree-l4"><a class="reference internal" href="swarmsim.Renderers.html#swarmsim-renderers">swarmsim.Renderers</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="swarmsim.Renderers.html#base-renderer-interface">Base Renderer Interface</a><ul>
<li class="toctree-l4"><a class="reference internal" href="swarmsim.Renderers.html#swarmsim.Renderers.renderer.Renderer"><code class="docutils literal notranslate"><span class="pre">Renderer</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="swarmsim.Renderers.html#standard-base-renderer">Standard Base Renderer</a><ul>
<li class="toctree-l4"><a class="reference internal" href="swarmsim.Renderers.html#swarmsim.Renderers.base_renderer.BaseRenderer"><code class="docutils literal notranslate"><span class="pre">BaseRenderer</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="swarmsim.Renderers.html#biological-systems-renderer">Biological Systems Renderer</a><ul>
<li class="toctree-l4"><a class="reference internal" href="swarmsim.Renderers.html#swarmsim.Renderers.bio_renderer.BioRenderer"><code class="docutils literal notranslate"><span class="pre">BioRenderer</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="swarmsim.Renderers.html#shepherding-renderer">Shepherding Renderer</a><ul>
<li class="toctree-l4"><a class="reference internal" href="swarmsim.Renderers.html#swarmsim.Renderers.shepherding_renderer.ShepherdingRenderer"><code class="docutils literal notranslate"><span class="pre">ShepherdingRenderer</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="swarmsim.Renderers.html#see-also">See Also</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Simulators Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#swarmsim-simulators">swarmsim.Simulators</a></li>
<li class="toctree-l4"><a class="reference internal" href="#package-overview">Package Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="#core-modules">Core Modules</a></li>
<li class="toctree-l4"><a class="reference internal" href="#usage-examples">Usage Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="#performance-optimization">Performance Optimization</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="swarmsim.Utils.html">Utilities Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="swarmsim.Utils.html#swarmsim-utils">swarmsim.Utils</a></li>
<li class="toctree-l4"><a class="reference internal" href="swarmsim.Utils.html#package-overview">Package Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="swarmsim.Utils.html#core-modules">Core Modules</a></li>
<li class="toctree-l4"><a class="reference internal" href="swarmsim.Utils.html#supporting-modules">Supporting Modules</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #2980B9" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">IntelliSwarm</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="swarmsim.html">IntelliSwarm Package</a></li>
      <li class="breadcrumb-item active">Simulators Package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/swarmsim.Simulators.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="simulators-package">
<h1>Simulators Package<a class="headerlink" href="#simulators-package" title="Link to this heading"></a></h1>
<p>The Simulators package provides the core simulation engines that coordinate all components
of a multi-agent simulation. Simulators manage the integration of populations, environments,
interactions, controllers, and data logging to create complete simulation systems.</p>
<section id="swarmsim-simulators">
<span id="module-swarmsim.Simulators"></span><h2>swarmsim.Simulators<a class="headerlink" href="#swarmsim-simulators" title="Link to this heading"></a></h2>
<p>This module provides simulation engines for orchestrating multi-agent system simulations.</p>
<p>The Simulators module contains the core simulation engines that coordinate all aspects
of multi-agent simulations, from basic research simulations to specialized reinforcement
learning environments. These simulators manage the execution flow, component integration,
and timing control for complex multi-agent systems.</p>
<section id="module-contents">
<h3>Module Contents<a class="headerlink" href="#module-contents" title="Link to this heading"></a></h3>
<blockquote>
<div><ul class="simple">
<li><p><cite>Simulator</cite> : Main simulation engine for research and analysis applications</p></li>
<li><p><cite>GymSimulator</cite> : OpenAI Gym-compatible simulator for reinforcement learning</p></li>
</ul>
</div></blockquote>
</section>
<section id="key-features">
<h3>Key Features<a class="headerlink" href="#key-features" title="Link to this heading"></a></h3>
<p><strong>Simulation Orchestration</strong>:</p>
<ul class="simple">
<li><p>Component coordination (populations, environment, interactions, controllers)</p></li>
<li><p>Execution flow management with proper sequencing</p></li>
<li><p>Progress tracking and early termination handling</p></li>
<li><p>Real-time visualization and data logging integration</p></li>
</ul>
<p><strong>Performance Optimization</strong>:</p>
<ul class="simple">
<li><p>Efficient timestep management and loop optimization</p></li>
<li><p>Configurable sampling rates for different components</p></li>
<li><p>Memory-efficient state management</p></li>
<li><p>Parallel interaction computation support</p></li>
</ul>
<p><strong>Flexibility and Extensibility</strong>:</p>
<ul class="simple">
<li><p>Modular architecture supporting custom components</p></li>
<li><p>Configuration-driven simulation parameters</p></li>
<li><p>Support for multiple simulation paradigms</p></li>
<li><p>Integration with visualization and analysis tools</p></li>
</ul>
<p class="rubric">Examples</p>
<p>Basic simulation setup:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">swarmsim.Simulators</span><span class="w"> </span><span class="kn">import</span> <span class="n">Simulator</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">swarmsim.Populations</span><span class="w"> </span><span class="kn">import</span> <span class="n">BrownianMotion</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">swarmsim.Environments</span><span class="w"> </span><span class="kn">import</span> <span class="n">EmptyEnvironment</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">swarmsim.Integrators</span><span class="w"> </span><span class="kn">import</span> <span class="n">EulerMaruyama</span>

<span class="c1"># Create simulation components</span>
<span class="n">population</span> <span class="o">=</span> <span class="n">BrownianMotion</span><span class="p">(</span><span class="n">config_path</span><span class="o">=</span><span class="s2">&quot;config.yaml&quot;</span><span class="p">)</span>
<span class="n">environment</span> <span class="o">=</span> <span class="n">EmptyEnvironment</span><span class="p">(</span><span class="n">config_path</span><span class="o">=</span><span class="s2">&quot;config.yaml&quot;</span><span class="p">)</span>
<span class="n">integrator</span> <span class="o">=</span> <span class="n">EulerMaruyama</span><span class="p">(</span><span class="n">config_path</span><span class="o">=</span><span class="s2">&quot;config.yaml&quot;</span><span class="p">)</span>

<span class="c1"># Create and run simulation</span>
<span class="n">simulator</span> <span class="o">=</span> <span class="n">Simulator</span><span class="p">(</span>
    <span class="n">config_path</span><span class="o">=</span><span class="s2">&quot;config.yaml&quot;</span><span class="p">,</span>
    <span class="n">populations</span><span class="o">=</span><span class="p">[</span><span class="n">population</span><span class="p">],</span>
    <span class="n">environment</span><span class="o">=</span><span class="n">environment</span><span class="p">,</span>
    <span class="n">integrator</span><span class="o">=</span><span class="n">integrator</span>
<span class="p">)</span>
<span class="n">simulator</span><span class="o">.</span><span class="n">simulate</span><span class="p">()</span>
</pre></div>
</div>
<p>Reinforcement learning setup:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">swarmsim.Simulators</span><span class="w"> </span><span class="kn">import</span> <span class="n">GymSimulator</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># Create RL-compatible simulator</span>
<span class="n">gym_sim</span> <span class="o">=</span> <span class="n">GymSimulator</span><span class="p">(</span>
    <span class="n">populations</span><span class="o">=</span><span class="p">[</span><span class="n">sheep</span><span class="p">,</span> <span class="n">herders</span><span class="p">],</span>
    <span class="n">interactions</span><span class="o">=</span><span class="p">[</span><span class="n">repulsion</span><span class="p">,</span> <span class="n">attraction</span><span class="p">],</span>
    <span class="n">environment</span><span class="o">=</span><span class="n">shepherding_env</span><span class="p">,</span>
    <span class="n">integrator</span><span class="o">=</span><span class="n">integrator</span><span class="p">,</span>
    <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">,</span>
    <span class="n">renderer</span><span class="o">=</span><span class="n">renderer</span><span class="p">,</span>
    <span class="n">config_path</span><span class="o">=</span><span class="s2">&quot;rl_config.yaml&quot;</span>
<span class="p">)</span>

<span class="c1"># RL training loop</span>
<span class="k">for</span> <span class="n">episode</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_episodes</span><span class="p">):</span>
    <span class="n">gym_sim</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">max_steps</span><span class="p">):</span>
        <span class="n">action</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">get_action</span><span class="p">(</span><span class="n">observation</span><span class="p">)</span>
        <span class="n">gym_sim</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>
        <span class="n">gym_sim</span><span class="o">.</span><span class="n">render</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="configuration">
<h3>Configuration<a class="headerlink" href="#configuration" title="Link to this heading"></a></h3>
<p>Simulator configuration via YAML:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">simulator</span><span class="p">:</span>
<span class="w">    </span><span class="nt">T</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100.0</span><span class="w">          </span><span class="c1"># Total simulation time</span>
<span class="w">    </span><span class="nt">dt</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.01</span><span class="w">          </span><span class="c1"># Timestep (inherited from integrator)</span>
<span class="w">    </span><span class="nt">progress_bar</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span><span class="w"> </span><span class="c1"># Show progress during simulation</span>
</pre></div>
</div>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>All simulators coordinate multiple simulation components in proper sequence</p></li>
<li><p>Timestep management ensures numerical stability and accuracy</p></li>
<li><p>Component sampling rates can be configured independently</p></li>
<li><p>Early termination is supported through logger done flags</p></li>
<li><p>Memory management prevents accumulation of interaction forces between timesteps</p></li>
</ul>
</section>
</section>
<section id="package-overview">
<h2>Package Overview<a class="headerlink" href="#package-overview" title="Link to this heading"></a></h2>
<p>Simulators in SwarmSim provide:</p>
<ul class="simple">
<li><p><strong>Component Coordination</strong>: Orchestrate interactions between all simulation elements</p></li>
<li><p><strong>Time Management</strong>: Handle simulation timing, stepping, and synchronization</p></li>
<li><p><strong>Integration Support</strong>: Work with various numerical integrators and time schemes</p></li>
<li><p><strong>Performance Monitoring</strong>: Track simulation performance and resource usage</p></li>
<li><p><strong>Flexible Architecture</strong>: Support different simulation paradigms and use cases</p></li>
</ul>
<p>The package includes specialized simulators for different applications, from basic
research simulations to reinforcement learning environments.</p>
</section>
<section id="core-modules">
<h2>Core Modules<a class="headerlink" href="#core-modules" title="Link to this heading"></a></h2>
<section id="base-simulator">
<h3>Base Simulator<a class="headerlink" href="#base-simulator" title="Link to this heading"></a></h3>
<p>The foundational simulator class that provides core simulation functionality.</p>
<dl class="py class" id="module-swarmsim.Simulators.base_simulator">
<dt class="sig sig-object py" id="swarmsim.Simulators.base_simulator.Simulator">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swarmsim.Simulators.base_simulator.</span></span><span class="sig-name descname"><span class="pre">Simulator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">populations</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">environment</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">integrator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interactions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">controllers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">renderer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/swarmsim/Simulators/base_simulator.html#Simulator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#swarmsim.Simulators.base_simulator.Simulator" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Main simulation engine that orchestrates multi-agent system simulations.</p>
<p>The Simulator class coordinates all components of a multi-agent system including populations,
environment, interactions, controllers, integrators, loggers, and renderers. It manages the
simulation loop and ensures proper execution order of all simulation steps.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>config_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Path to the YAML configuration file containing simulation parameters.</p></li>
<li><p><strong>populations</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em> of </em><a class="reference internal" href="swarmsim.Populations.html#swarmsim.Populations.population.Population" title="swarmsim.Populations.population.Population"><em>Population</em></a>) – List of agent populations to simulate.</p></li>
<li><p><strong>environment</strong> (<a class="reference internal" href="swarmsim.Environments.html#swarmsim.Environments.Environment" title="swarmsim.Environments.Environment"><em>Environment</em></a>) – The environment in which agents operate.</p></li>
<li><p><strong>integrator</strong> (<a class="reference internal" href="swarmsim.Integrators.html#swarmsim.Integrators.base_integrator.Integrator" title="swarmsim.Integrators.base_integrator.Integrator"><em>Integrator</em></a>) – Numerical integration scheme for updating agent states.</p></li>
<li><p><strong>interactions</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em> of </em><a class="reference internal" href="swarmsim.Interactions.html#swarmsim.Interactions.Interaction" title="swarmsim.Interactions.Interaction"><em>Interaction</em></a><em>, </em><em>optional</em>) – List of interaction models between agents. Default is None.</p></li>
<li><p><strong>controllers</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em> of </em><a class="reference internal" href="swarmsim.Controllers.html#swarmsim.Controllers.base_controller.Controller" title="swarmsim.Controllers.base_controller.Controller"><em>Controller</em></a><em>, </em><em>optional</em>) – List of controllers that influence agent behavior. Default is None.</p></li>
<li><p><strong>logger</strong> (<a class="reference internal" href="swarmsim.Loggers.html#swarmsim.Loggers.logger.Logger" title="swarmsim.Loggers.logger.Logger"><em>Logger</em></a><em>, </em><em>optional</em>) – Logger instance for recording simulation data. Default is None.</p></li>
<li><p><strong>renderer</strong> (<a class="reference internal" href="swarmsim.Renderers.html#swarmsim.Renderers.renderer.Renderer" title="swarmsim.Renderers.renderer.Renderer"><em>Renderer</em></a><em>, </em><em>optional</em>) – Renderer instance for visualization. Default is None.</p></li>
</ul>
</dd>
<dt class="field-even">Variables<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Simulation timestep, inherited from the integrator.</p></li>
<li><p><strong>T</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Total simulation time duration.</p></li>
<li><p><strong>populations</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em> of </em><a class="reference internal" href="swarmsim.Populations.html#swarmsim.Populations.population.Population" title="swarmsim.Populations.population.Population"><em>Population</em></a>) – List of agent populations in the simulation.</p></li>
<li><p><strong>environment</strong> (<a class="reference internal" href="swarmsim.Environments.html#swarmsim.Environments.Environment" title="swarmsim.Environments.Environment"><em>Environment</em></a>) – The simulation environment.</p></li>
<li><p><strong>interactions</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em> of </em><a class="reference internal" href="swarmsim.Interactions.html#swarmsim.Interactions.Interaction" title="swarmsim.Interactions.Interaction"><em>Interaction</em></a><em> or </em><em>None</em>) – List of interaction models.</p></li>
<li><p><strong>controllers</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em> of </em><a class="reference internal" href="swarmsim.Controllers.html#swarmsim.Controllers.base_controller.Controller" title="swarmsim.Controllers.base_controller.Controller"><em>Controller</em></a><em> or </em><em>None</em>) – List of control strategies.</p></li>
<li><p><strong>logger</strong> (<a class="reference internal" href="swarmsim.Loggers.html#swarmsim.Loggers.logger.Logger" title="swarmsim.Loggers.logger.Logger"><em>Logger</em></a><em> or </em><em>None</em>) – Data logger instance.</p></li>
<li><p><strong>renderer</strong> (<a class="reference internal" href="swarmsim.Renderers.html#swarmsim.Renderers.renderer.Renderer" title="swarmsim.Renderers.renderer.Renderer"><em>Renderer</em></a><em> or </em><em>None</em>) – Visualization renderer.</p></li>
<li><p><strong>integrator</strong> (<a class="reference internal" href="swarmsim.Integrators.html#swarmsim.Integrators.base_integrator.Integrator" title="swarmsim.Integrators.base_integrator.Integrator"><em>Integrator</em></a>) – Numerical integration scheme.</p></li>
</ul>
</dd>
<dt class="field-odd">Config Requirements<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>The YAML configuration file must contain the following parameters under the simulator section</strong></p></li>
<li><p><strong>T</strong> (<em>float, optional</em>) – Total simulation time. Default is <code class="docutils literal notranslate"><span class="pre">10.0</span></code>.</p></li>
<li><p><strong>dt</strong> (<em>float, optional</em>) – Simulation timestep. Default is <code class="docutils literal notranslate"><span class="pre">0.01</span></code>.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The simulation loop executes the following steps in order:</p>
<ol class="arabic simple">
<li><p><strong>Logging</strong>: Record current simulation state</p></li>
<li><p><strong>Rendering</strong>: Visualize current state (if renderer is provided)</p></li>
<li><p><strong>Control</strong>: Computes control actions (if controllers are provided)</p></li>
<li><p><strong>Interactions</strong>: Computes inter-agent forces (if interactions are provided)</p></li>
<li><p><strong>Integration</strong>: Update agent states using numerical integration</p></li>
<li><p><strong>Reset Forces</strong>: Clear interaction forces for next timestep</p></li>
<li><p><strong>Environment Update</strong>: Update environment state</p></li>
</ol>
<p class="rubric">Examples</p>
<p>Basic simulation setup:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">swarmsim</span><span class="w"> </span><span class="kn">import</span> <span class="n">BrownianMotion</span><span class="p">,</span> <span class="n">Simulator</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">swarmsim.Environments</span><span class="w"> </span><span class="kn">import</span> <span class="n">EmptyEnvironment</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">swarmsim.Integrators</span><span class="w"> </span><span class="kn">import</span> <span class="n">EulerMaruyama</span>

<span class="c1"># Create components</span>
<span class="n">population</span> <span class="o">=</span> <span class="n">BrownianMotion</span><span class="p">(</span><span class="s1">&#39;config.yaml&#39;</span><span class="p">)</span>
<span class="n">environment</span> <span class="o">=</span> <span class="n">EmptyEnvironment</span><span class="p">(</span><span class="s1">&#39;config.yaml&#39;</span><span class="p">)</span>
<span class="n">integrator</span> <span class="o">=</span> <span class="n">EulerMaruyama</span><span class="p">(</span><span class="s1">&#39;config.yaml&#39;</span><span class="p">)</span>

<span class="c1"># Create and run simulator</span>
<span class="n">simulator</span> <span class="o">=</span> <span class="n">Simulator</span><span class="p">(</span>
    <span class="n">config_path</span><span class="o">=</span><span class="s1">&#39;config.yaml&#39;</span><span class="p">,</span>
    <span class="n">populations</span><span class="o">=</span><span class="p">[</span><span class="n">population</span><span class="p">],</span>
    <span class="n">environment</span><span class="o">=</span><span class="n">environment</span><span class="p">,</span>
    <span class="n">integrator</span><span class="o">=</span><span class="n">integrator</span>
<span class="p">)</span>
<span class="n">simulator</span><span class="o">.</span><span class="n">simulate</span><span class="p">()</span>
</pre></div>
</div>
<p>Example YAML configuration:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">simulator</span><span class="p">:</span>
<span class="w">    </span><span class="nt">T</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">50.0</span><span class="w">  </span><span class="c1"># Run simulation for 50 time units</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="swarmsim.Simulators.base_simulator.Simulator.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">populations</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">environment</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">integrator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interactions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">controllers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">renderer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/swarmsim/Simulators/base_simulator.html#Simulator.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#swarmsim.Simulators.base_simulator.Simulator.__init__" title="Link to this definition"></a></dt>
<dd><p>Initialize the Simulator with all required and optional components.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>config_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Path to the YAML configuration file containing simulation parameters.</p></li>
<li><p><strong>populations</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em> of </em><a class="reference internal" href="swarmsim.Populations.html#swarmsim.Populations.population.Population" title="swarmsim.Populations.population.Population"><em>Population</em></a>) – List of agent populations to include in the simulation.</p></li>
<li><p><strong>environment</strong> (<a class="reference internal" href="swarmsim.Environments.html#swarmsim.Environments.Environment" title="swarmsim.Environments.Environment"><em>Environment</em></a>) – The environment where agents operate.</p></li>
<li><p><strong>integrator</strong> (<a class="reference internal" href="swarmsim.Integrators.html#swarmsim.Integrators.base_integrator.Integrator" title="swarmsim.Integrators.base_integrator.Integrator"><em>Integrator</em></a>) – Numerical integration scheme for state evolution.</p></li>
<li><p><strong>interactions</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em> of </em><a class="reference internal" href="swarmsim.Interactions.html#swarmsim.Interactions.Interaction" title="swarmsim.Interactions.Interaction"><em>Interaction</em></a><em>, </em><em>optional</em>) – Inter-agent interaction models. Default is None.</p></li>
<li><p><strong>controllers</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em> of </em><a class="reference internal" href="swarmsim.Controllers.html#swarmsim.Controllers.base_controller.Controller" title="swarmsim.Controllers.base_controller.Controller"><em>Controller</em></a><em>, </em><em>optional</em>) – Control strategies for influencing agent behavior. Default is None.</p></li>
<li><p><strong>logger</strong> (<a class="reference internal" href="swarmsim.Loggers.html#swarmsim.Loggers.logger.Logger" title="swarmsim.Loggers.logger.Logger"><em>Logger</em></a><em>, </em><em>optional</em>) – Data recording component. Default is None.</p></li>
<li><p><strong>renderer</strong> (<a class="reference internal" href="swarmsim.Renderers.html#swarmsim.Renderers.renderer.Renderer" title="swarmsim.Renderers.renderer.Renderer"><em>Renderer</em></a><em>, </em><em>optional</em>) – Visualization component. Default is None.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#FileNotFoundError" title="(in Python v3.13)"><strong>FileNotFoundError</strong></a> – If the configuration file cannot be found.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swarmsim.Simulators.base_simulator.Simulator.simulate">
<span class="sig-name descname"><span class="pre">simulate</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/swarmsim/Simulators/base_simulator.html#Simulator.simulate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#swarmsim.Simulators.base_simulator.Simulator.simulate" title="Link to this definition"></a></dt>
<dd><p>Execute the main simulation loop.</p>
<p>This method runs the complete simulation from t=0 to t=T, coordinating all
simulation components in the proper sequence. It includes progress tracking
and handles early termination if requested by the logger.</p>
<p>The simulation loop performs the following steps at each timestep:</p>
<ol class="arabic simple">
<li><p><strong>Data Logging</strong>: Record current simulation state and check for termination</p></li>
<li><p><strong>Visualization</strong>: Render current state if renderer is available</p></li>
<li><p><strong>Control Actions</strong>: Apply control inputs from all controllers</p></li>
<li><p><strong>Agent Interactions</strong>: Compute forces between agents</p></li>
<li><p><strong>State Integration</strong>: Update agent positions using the integrator</p></li>
<li><p><strong>Force Reset</strong>: Clear interaction forces for the next timestep</p></li>
<li><p><strong>Environment Update</strong>: Update environmental conditions</p></li>
</ol>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Progress is displayed using a progress bar</p></li>
<li><p>Controllers operate at their specified sampling rates</p></li>
<li><p>Interaction forces are reset at each timestep</p></li>
<li><p>Early termination is possible if the logger returns a done flag</p></li>
<li><p>All populations are reset to initial conditions before simulation starts</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError" title="(in Python v3.13)"><strong>RuntimeError</strong></a> – If any component fails during simulation execution.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<p>Key Features:</p>
<ul class="simple">
<li><p><strong>Component Integration</strong>: Seamlessly coordinate populations, environments, and interactions</p></li>
<li><p><strong>Flexible Stepping</strong>: Support both fixed and adaptive time stepping</p></li>
<li><p><strong>State Management</strong>: Maintain complete simulation state and history</p></li>
<li><p><strong>Event Handling</strong>: Process simulation events and state changes</p></li>
<li><p><strong>Extensible Design</strong>: Easy to extend for specialized simulation needs</p></li>
</ul>
<p>Core Capabilities:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">simulator</span> <span class="o">=</span> <span class="n">BaseSimulator</span><span class="p">(</span>
    <span class="n">populations</span><span class="o">=</span><span class="p">[</span><span class="n">population1</span><span class="p">,</span> <span class="n">population2</span><span class="p">],</span>
    <span class="n">environment</span><span class="o">=</span><span class="n">environment</span><span class="p">,</span>
    <span class="n">interactions</span><span class="o">=</span><span class="p">[</span><span class="n">interaction1</span><span class="p">,</span> <span class="n">interaction2</span><span class="p">],</span>
    <span class="n">integrator</span><span class="o">=</span><span class="n">integrator</span><span class="p">,</span>
    <span class="n">dt</span><span class="o">=</span><span class="mf">0.01</span>
<span class="p">)</span>

<span class="c1"># Basic simulation loop</span>
<span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">):</span>
    <span class="n">simulator</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="gym-simulator">
<h3>Gym Simulator<a class="headerlink" href="#gym-simulator" title="Link to this heading"></a></h3>
<p>Specialized simulator implementing OpenAI Gym interface for reinforcement learning applications.</p>
<dl class="py class" id="module-swarmsim.Simulators.gym_simulator">
<dt class="sig sig-object py" id="swarmsim.Simulators.gym_simulator.GymSimulator">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swarmsim.Simulators.gym_simulator.</span></span><span class="sig-name descname"><span class="pre">GymSimulator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">populations</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interactions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">environment</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">integrator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">renderer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">render_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/swarmsim/Simulators/gym_simulator.html#GymSimulator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#swarmsim.Simulators.gym_simulator.GymSimulator" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#swarmsim.Simulators.base_simulator.Simulator" title="swarmsim.Simulators.base_simulator.Simulator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Simulator</span></code></a></p>
<p>OpenAI Gym-compatible simulator for reinforcement learning applications.</p>
<p>This simulator extends the base Simulator class to provide a Gym-style interface
suitable for reinforcement learning algorithms. It implements the standard
<code class="docutils literal notranslate"><span class="pre">reset()</span></code>, <code class="docutils literal notranslate"><span class="pre">step()</span></code>, <code class="docutils literal notranslate"><span class="pre">render()</span></code>, and <code class="docutils literal notranslate"><span class="pre">close()</span></code> methods expected by
RL frameworks while maintaining full compatibility with the swarmsim ecosystem.</p>
<p>The GymSimulator is specifically designed for scenarios where one population
(typically herders or controllers) receives actions from an RL agent, while
other populations follow their programmed dynamics. This makes it ideal for
training agents in multi-agent environments like shepherding, swarm control,
or cooperative robotics.</p>
<section id="id1">
<h4>Key Features<a class="headerlink" href="#id1" title="Link to this heading"></a></h4>
<p><strong>RL Compatibility</strong>:</p>
<ul class="simple">
<li><p>Standard Gym interface (reset, step, render, close)</p></li>
<li><p>Configurable render modes including “rgb_array” for headless training</p></li>
<li><p>Episode-based simulation management</p></li>
<li><p>Action space integration with swarmsim populations</p></li>
</ul>
<p><strong>Multi-Agent Integration</strong>:</p>
<ul class="simple">
<li><p>Seamless integration with existing swarmsim components</p></li>
<li><p>Support for mixed controlled/autonomous populations</p></li>
<li><p>Interaction computation between all agent types</p></li>
<li><p>Environment state management across episodes</p></li>
</ul>
<p><strong>Training Optimization</strong>:</p>
<ul class="simple">
<li><p>Efficient episode reset without full reinitialization</p></li>
<li><p>Configurable rendering for training vs evaluation</p></li>
<li><p>Memory management for long training sessions</p></li>
<li><p>Component state preservation between episodes</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">param populations<span class="colon">:</span></dt>
<dd class="field-odd"><p>List of agent populations, where populations[1] is typically controlled by RL actions.</p>
</dd>
<dt class="field-even">type populations<span class="colon">:</span></dt>
<dd class="field-even"><p>list of Population</p>
</dd>
<dt class="field-odd">param interactions<span class="colon">:</span></dt>
<dd class="field-odd"><p>Inter-agent interaction models applied during simulation.</p>
</dd>
<dt class="field-even">type interactions<span class="colon">:</span></dt>
<dd class="field-even"><p>list of Interaction</p>
</dd>
<dt class="field-odd">param environment<span class="colon">:</span></dt>
<dd class="field-odd"><p>The environment instance containing spatial and physical constraints.</p>
</dd>
<dt class="field-even">type environment<span class="colon">:</span></dt>
<dd class="field-even"><p>Environment</p>
</dd>
<dt class="field-odd">param integrator<span class="colon">:</span></dt>
<dd class="field-odd"><p>Numerical integration scheme for updating agent states.</p>
</dd>
<dt class="field-even">type integrator<span class="colon">:</span></dt>
<dd class="field-even"><p>Integrator</p>
</dd>
<dt class="field-odd">param logger<span class="colon">:</span></dt>
<dd class="field-odd"><p>Data recording component for tracking training metrics.</p>
</dd>
<dt class="field-even">type logger<span class="colon">:</span></dt>
<dd class="field-even"><p>Logger</p>
</dd>
<dt class="field-odd">param renderer<span class="colon">:</span></dt>
<dd class="field-odd"><p>Visualization component with configurable render modes.</p>
</dd>
<dt class="field-even">type renderer<span class="colon">:</span></dt>
<dd class="field-even"><p>Renderer</p>
</dd>
<dt class="field-odd">param render_mode<span class="colon">:</span></dt>
<dd class="field-odd"><p>Rendering mode: “human” for display, “rgb_array” for numpy arrays. Default is None.</p>
</dd>
<dt class="field-even">type render_mode<span class="colon">:</span></dt>
<dd class="field-even"><p>str, optional</p>
</dd>
<dt class="field-odd">param config_path<span class="colon">:</span></dt>
<dd class="field-odd"><p>Path to YAML configuration file with simulation parameters.</p>
</dd>
<dt class="field-even">type config_path<span class="colon">:</span></dt>
<dd class="field-even"><p>str, optional</p>
</dd>
<dt class="field-odd">ivar render_mode<span class="colon">:</span></dt>
<dd class="field-odd"><p>Current rendering mode configuration.</p>
</dd>
<dt class="field-even">vartype render_mode<span class="colon">:</span></dt>
<dd class="field-even"><p>str or None</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="swarmsim.Simulators.gym_simulator.GymSimulator.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/swarmsim/Simulators/gym_simulator.html#GymSimulator.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#swarmsim.Simulators.gym_simulator.GymSimulator.reset" title="Link to this definition"></a></dt>
<dd><p>Reset all simulation components to initial states for new episode.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swarmsim.Simulators.gym_simulator.GymSimulator.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/swarmsim/Simulators/gym_simulator.html#GymSimulator.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#swarmsim.Simulators.gym_simulator.GymSimulator.step" title="Link to this definition"></a></dt>
<dd><p>Execute one simulation timestep with the provided action.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swarmsim.Simulators.gym_simulator.GymSimulator.render">
<span class="sig-name descname"><span class="pre">render</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/swarmsim/Simulators/gym_simulator.html#GymSimulator.render"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#swarmsim.Simulators.gym_simulator.GymSimulator.render" title="Link to this definition"></a></dt>
<dd><p>Render current simulation state according to render_mode.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swarmsim.Simulators.gym_simulator.GymSimulator.close">
<span class="sig-name descname"><span class="pre">close</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/swarmsim/Simulators/gym_simulator.html#GymSimulator.close"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#swarmsim.Simulators.gym_simulator.GymSimulator.close" title="Link to this definition"></a></dt>
<dd><p>Clean up simulation resources and close rendering.</p>
</dd></dl>

<p class="rubric">Examples</p>
<p>Basic RL setup for shepherding:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">swarmsim.Simulators</span><span class="w"> </span><span class="kn">import</span> <span class="n">GymSimulator</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">swarmsim.Populations</span><span class="w"> </span><span class="kn">import</span> <span class="n">BrownianMotion</span><span class="p">,</span> <span class="n">SimpleIntegrators</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">swarmsim.Environments</span><span class="w"> </span><span class="kn">import</span> <span class="n">ShepherdingEnvironment</span>

<span class="c1"># Create populations (sheep and herders)</span>
<span class="n">sheep</span> <span class="o">=</span> <span class="n">BrownianMotion</span><span class="p">(</span><span class="n">config_path</span><span class="o">=</span><span class="s2">&quot;sheep_config.yaml&quot;</span><span class="p">)</span>
<span class="n">herders</span> <span class="o">=</span> <span class="n">SimpleIntegrators</span><span class="p">(</span><span class="n">config_path</span><span class="o">=</span><span class="s2">&quot;herder_config.yaml&quot;</span><span class="p">)</span>

<span class="c1"># Create RL-compatible simulator</span>
<span class="n">gym_sim</span> <span class="o">=</span> <span class="n">GymSimulator</span><span class="p">(</span>
    <span class="n">populations</span><span class="o">=</span><span class="p">[</span><span class="n">sheep</span><span class="p">,</span> <span class="n">herders</span><span class="p">],</span>  <span class="c1"># herders[1] will receive RL actions</span>
    <span class="n">interactions</span><span class="o">=</span><span class="p">[</span><span class="n">repulsion</span><span class="p">,</span> <span class="n">attraction</span><span class="p">],</span>
    <span class="n">environment</span><span class="o">=</span><span class="n">shepherding_env</span><span class="p">,</span>
    <span class="n">integrator</span><span class="o">=</span><span class="n">integrator</span><span class="p">,</span>
    <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">,</span>
    <span class="n">renderer</span><span class="o">=</span><span class="n">renderer</span><span class="p">,</span>
    <span class="n">render_mode</span><span class="o">=</span><span class="s2">&quot;rgb_array&quot;</span>  <span class="c1"># For headless training</span>
<span class="p">)</span>

<span class="c1"># RL training loop</span>
<span class="k">for</span> <span class="n">episode</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">):</span>
    <span class="n">gym_sim</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
    <span class="n">done</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">while</span> <span class="ow">not</span> <span class="n">done</span><span class="p">:</span>
        <span class="n">action</span> <span class="o">=</span> <span class="n">rl_agent</span><span class="o">.</span><span class="n">get_action</span><span class="p">()</span>  <span class="c1"># Shape: (n_herders, action_dim)</span>
        <span class="n">gym_sim</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>
        <span class="n">frame</span> <span class="o">=</span> <span class="n">gym_sim</span><span class="o">.</span><span class="n">render</span><span class="p">()</span>  <span class="c1"># Returns numpy array</span>
        <span class="n">done</span> <span class="o">=</span> <span class="n">gym_sim</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">check_termination</span><span class="p">()</span>
</pre></div>
</div>
<p>Integration with popular RL libraries:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">gym</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">stable_baselines3</span><span class="w"> </span><span class="kn">import</span> <span class="n">PPO</span>

<span class="c1"># Wrap GymSimulator in Gym environment</span>
<span class="k">class</span><span class="w"> </span><span class="nc">SwarmEnv</span><span class="p">(</span><span class="n">gym</span><span class="o">.</span><span class="n">Env</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">simulator</span> <span class="o">=</span> <span class="n">GymSimulator</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">action_space</span> <span class="o">=</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Box</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">observation_space</span> <span class="o">=</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Box</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">simulator</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_observation</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">action</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">simulator</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>
        <span class="n">obs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_observation</span><span class="p">()</span>
        <span class="n">reward</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compute_reward</span><span class="p">()</span>
        <span class="n">done</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_done</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">obs</span><span class="p">,</span> <span class="n">reward</span><span class="p">,</span> <span class="n">done</span><span class="p">,</span> <span class="p">{}</span>

<span class="c1"># Train with stable-baselines3</span>
<span class="n">env</span> <span class="o">=</span> <span class="n">SwarmEnv</span><span class="p">()</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">PPO</span><span class="p">(</span><span class="s2">&quot;MlpPolicy&quot;</span><span class="p">,</span> <span class="n">env</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">learn</span><span class="p">(</span><span class="n">total_timesteps</span><span class="o">=</span><span class="mi">100000</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The controlled population is assumed to be populations[1] by convention</p></li>
<li><p>Actions are directly assigned to the controlled population’s input (u)</p></li>
<li><p>All populations and interactions are reset between episodes</p></li>
<li><p>Logger provides episode termination signals through done flags</p></li>
<li><p>Rendering behavior depends on the render_mode configuration</p></li>
</ul>
<dl class="py method">
<dt class="sig sig-object py" id="swarmsim.Simulators.gym_simulator.GymSimulator.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">populations</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interactions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">environment</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">integrator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">renderer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">render_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/swarmsim/Simulators/gym_simulator.html#GymSimulator.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#swarmsim.Simulators.gym_simulator.GymSimulator.__init__" title="Link to this definition"></a></dt>
<dd><p>Initializes the Simulator class with configuration parameters from a YAML file.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>config_path (str): The path to the YAML configuration file.</p>
</dd>
</dl>
<dl class="field-list simple">
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id0">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/swarmsim/Simulators/gym_simulator.html#GymSimulator.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id0" title="Link to this definition"></a></dt>
<dd><p>Reset all simulation components to initial states for new episode.</p>
<p>This method prepares the simulator for a new episode by resetting all
populations, interactions, and logger to their initial configurations.
It ensures that each episode starts from a clean, reproducible state.</p>
<section id="reset-operations">
<h5>Reset Operations<a class="headerlink" href="#reset-operations" title="Link to this heading"></a></h5>
<ol class="arabic simple">
<li><p><strong>Population Reset</strong>: All agent populations return to initial positions and states</p></li>
<li><p><strong>Interaction Reset</strong>: Interaction models clear any accumulated state</p></li>
<li><p><strong>Logger Reset</strong>: Logging system prepares for new episode data collection</p></li>
</ol>
<p class="rubric">Performance Notes</p>
<ul class="simple">
<li><p>Optimized to avoid full component reinitialization</p></li>
<li><p>Reuses existing object instances for memory efficiency</p></li>
<li><p>Faster than creating new simulator instance</p></li>
</ul>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Called at the beginning of each RL episode</p></li>
<li><p>Does not reset renderer or environment (typically persistent)</p></li>
<li><p>Maintains component configurations while resetting states</p></li>
</ul>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id2">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/swarmsim/Simulators/gym_simulator.html#GymSimulator.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id2" title="Link to this definition"></a></dt>
<dd><p>Execute one simulation timestep with the provided RL action.</p>
<p>This method advances the simulation by one timestep, applying the provided
action to the controlled population and updating all system components
according to the standard simulation pipeline.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>action</strong> (<em>np.ndarray</em>) – Control action for the controlled population. Shape should match
the controlled population’s input dimension: (n_agents, input_dim).</p></li>
<li><p><strong>Pipeline</strong> (<em>Simulation</em>)</p></li>
<li><p><strong>-------------------</strong></p></li>
<li><p><strong>Application</strong> (<em>1. Action</em>)</p></li>
<li><p><strong>Computation</strong> (<em>2. Interaction</em>)</p></li>
<li><p><strong>Integration</strong> (<em>3. State</em>)</p></li>
<li><p><strong>Reset</strong> (<em>4. Force</em>)</p></li>
<li><p><strong>Update</strong> (<em>5. Environment</em>)</p></li>
<li><p><strong>Space</strong> (<em>Action</em>)</p></li>
<li><p><strong>------------</strong></p></li>
<li><p><strong>application</strong> (<em>The action space depends on the controlled population and</em>)</p></li>
<li><p><strong>Control</strong> (<em>- Acceleration</em>)</p></li>
<li><p><strong>Control</strong></p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Assumes populations[1] is the controlled population by convention</p></li>
<li><p>Action dimensions must match controlled population’s input_dim</p></li>
<li><p>Forces are automatically reset after each timestep</p></li>
<li><p>Environment state can change dynamically during simulation</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id3">
<span class="sig-name descname"><span class="pre">render</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/swarmsim/Simulators/gym_simulator.html#GymSimulator.render"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id3" title="Link to this definition"></a></dt>
<dd><p>Render the current simulation state according to configured render mode.</p>
<p>This method provides flexible rendering output depending on the render_mode
setting, supporting both human visualization and programmatic access to
rendered frames for analysis or recording.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><em>np.ndarray or None</em> –</p>
<ul>
<li><p>If render_mode == “rgb_array”: Returns numpy array of shape (height, width, 3)</p></li>
<li><p>Otherwise: Returns None, displays visualization</p></li>
</ul>
</li>
<li><p><em>Render Modes</em></p></li>
<li><p><em>————</em></p></li>
<li><p><em>**”rgb_array” Mode**</em></p></li>
<li><p><em>- Returns rendered frame as numpy array</em></p></li>
<li><p><em>- Suitable for headless training and automated analysis</em></p></li>
<li><p><em>- Efficient for batch processing and video generation</em></p></li>
<li><p><em>- Compatible with gym.wrappers.RecordVideo</em></p></li>
<li><p><em>**Other Mode**</em></p></li>
<li><p><em>- Displays visualization in real-time window</em></p></li>
<li><p><em>- Interactive visualization with user controls</em></p></li>
<li><p><em>- Suitable for debugging and demonstration</em></p></li>
<li><p><em>- May block execution depending on renderer implementation</em></p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Render mode can be changed dynamically during simulation</p></li>
<li><p>Frame dimensions depend on renderer configuration</p></li>
<li><p>Some renderers may not support all render modes</p></li>
<li><p>Rendering quality vs performance trade-offs are renderer-dependent</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id4">
<span class="sig-name descname"><span class="pre">close</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/swarmsim/Simulators/gym_simulator.html#GymSimulator.close"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id4" title="Link to this definition"></a></dt>
<dd></dd></dl>

</section>
<dl class="field-list simple">
</dl>
</dd></dl>

<p>Key Features:</p>
<ul class="simple">
<li><p><strong>OpenAI Gym Interface</strong>: Standard RL environment interface (step, reset, render)</p></li>
<li><p><strong>Action/Observation Spaces</strong>: Configurable action and observation spaces</p></li>
<li><p><strong>Reward Functions</strong>: Flexible reward function definition</p></li>
<li><p><strong>Episode Management</strong>: Handle episode termination and reset conditions</p></li>
<li><p><strong>Multi-Agent Support</strong>: Extensions for multi-agent reinforcement learning</p></li>
</ul>
<p>RL Integration:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">gym_sim</span> <span class="o">=</span> <span class="n">GymSimulator</span><span class="p">(</span>
    <span class="n">populations</span><span class="o">=</span><span class="p">[</span><span class="n">agents</span><span class="p">],</span>
    <span class="n">environment</span><span class="o">=</span><span class="n">env</span><span class="p">,</span>
    <span class="n">action_space</span><span class="o">=</span><span class="n">action_space</span><span class="p">,</span>
    <span class="n">observation_space</span><span class="o">=</span><span class="n">obs_space</span><span class="p">,</span>
    <span class="n">reward_function</span><span class="o">=</span><span class="n">reward_fn</span>
<span class="p">)</span>

<span class="c1"># Standard RL training loop</span>
<span class="n">obs</span> <span class="o">=</span> <span class="n">gym_sim</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
<span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">episode_length</span><span class="p">):</span>
    <span class="n">action</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">act</span><span class="p">(</span><span class="n">obs</span><span class="p">)</span>
    <span class="n">obs</span><span class="p">,</span> <span class="n">reward</span><span class="p">,</span> <span class="n">done</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">gym_sim</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">done</span><span class="p">:</span>
        <span class="k">break</span>
</pre></div>
</div>
</section>
</section>
<section id="usage-examples">
<h2>Usage Examples<a class="headerlink" href="#usage-examples" title="Link to this heading"></a></h2>
<section id="basic-simulation-setup">
<h3>Basic Simulation Setup<a class="headerlink" href="#basic-simulation-setup" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">swarmsim.Simulators</span><span class="w"> </span><span class="kn">import</span> <span class="n">BaseSimulator</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">swarmsim.Populations</span><span class="w"> </span><span class="kn">import</span> <span class="n">BrownianMotion</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">swarmsim.Environments</span><span class="w"> </span><span class="kn">import</span> <span class="n">EmptyEnvironment</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">swarmsim.Interactions</span><span class="w"> </span><span class="kn">import</span> <span class="n">LennardJones</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">swarmsim.Integrators</span><span class="w"> </span><span class="kn">import</span> <span class="n">EulerMaruyama</span>

<span class="c1"># Create simulation components</span>
<span class="n">population</span> <span class="o">=</span> <span class="n">BrownianMotion</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">x_dim</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">environment</span> <span class="o">=</span> <span class="n">EmptyEnvironment</span><span class="p">(</span><span class="n">boundary_size</span><span class="o">=</span><span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">])</span>
<span class="n">interaction</span> <span class="o">=</span> <span class="n">LennardJones</span><span class="p">(</span><span class="n">epsilon</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<span class="n">integrator</span> <span class="o">=</span> <span class="n">EulerMaruyama</span><span class="p">(</span><span class="n">dt</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>

<span class="c1"># Create and configure simulator</span>
<span class="n">simulator</span> <span class="o">=</span> <span class="n">BaseSimulator</span><span class="p">(</span>
    <span class="n">populations</span><span class="o">=</span><span class="p">[</span><span class="n">population</span><span class="p">],</span>
    <span class="n">environment</span><span class="o">=</span><span class="n">environment</span><span class="p">,</span>
    <span class="n">interactions</span><span class="o">=</span><span class="p">[</span><span class="n">interaction</span><span class="p">],</span>
    <span class="n">integrator</span><span class="o">=</span><span class="n">integrator</span><span class="p">,</span>
    <span class="n">dt</span><span class="o">=</span><span class="mf">0.01</span>
<span class="p">)</span>

<span class="c1"># Run simulation</span>
<span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">):</span>
    <span class="n">simulator</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>

    <span class="c1"># Access simulation state</span>
    <span class="n">positions</span> <span class="o">=</span> <span class="n">simulator</span><span class="o">.</span><span class="n">get_positions</span><span class="p">()</span>
    <span class="n">velocities</span> <span class="o">=</span> <span class="n">simulator</span><span class="o">.</span><span class="n">get_velocities</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="multi-population-simulation">
<h3>Multi-Population Simulation<a class="headerlink" href="#multi-population-simulation" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">swarmsim.Simulators</span><span class="w"> </span><span class="kn">import</span> <span class="n">BaseSimulator</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">swarmsim.Populations</span><span class="w"> </span><span class="kn">import</span> <span class="n">BrownianMotion</span><span class="p">,</span> <span class="n">SimpleIntegrators</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">swarmsim.Interactions</span><span class="w"> </span><span class="kn">import</span> <span class="n">PowerLawRepulsion</span>

<span class="c1"># Create multiple populations</span>
<span class="n">prey</span> <span class="o">=</span> <span class="n">BrownianMotion</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">x_dim</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">species_id</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">predators</span> <span class="o">=</span> <span class="n">SimpleIntegrators</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">x_dim</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">species_id</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Species-specific interactions</span>
<span class="n">prey_interaction</span> <span class="o">=</span> <span class="n">PowerLawRepulsion</span><span class="p">(</span>
    <span class="n">species_pairs</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)],</span>  <span class="c1"># Prey-prey repulsion</span>
    <span class="n">strength</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
    <span class="n">power</span><span class="o">=</span><span class="mi">2</span>
<span class="p">)</span>

<span class="n">predator_interaction</span> <span class="o">=</span> <span class="n">PowerLawRepulsion</span><span class="p">(</span>
    <span class="n">species_pairs</span><span class="o">=</span><span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)],</span>  <span class="c1"># Predator-prey attraction</span>
    <span class="n">strength</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span>
    <span class="n">power</span><span class="o">=</span><span class="mi">1</span>
<span class="p">)</span>

<span class="c1"># Multi-species simulation</span>
<span class="n">simulator</span> <span class="o">=</span> <span class="n">BaseSimulator</span><span class="p">(</span>
    <span class="n">populations</span><span class="o">=</span><span class="p">[</span><span class="n">prey</span><span class="p">,</span> <span class="n">predators</span><span class="p">],</span>
    <span class="n">environment</span><span class="o">=</span><span class="n">environment</span><span class="p">,</span>
    <span class="n">interactions</span><span class="o">=</span><span class="p">[</span><span class="n">prey_interaction</span><span class="p">,</span> <span class="n">predator_interaction</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="controlled-simulation">
<h3>Controlled Simulation<a class="headerlink" href="#controlled-simulation" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">swarmsim.Simulators</span><span class="w"> </span><span class="kn">import</span> <span class="n">BaseSimulator</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">swarmsim.Controllers</span><span class="w"> </span><span class="kn">import</span> <span class="n">ShepherdingController</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">swarmsim.Loggers</span><span class="w"> </span><span class="kn">import</span> <span class="n">Logger</span>

<span class="c1"># Setup with controller and logging</span>
<span class="n">simulator</span> <span class="o">=</span> <span class="n">BaseSimulator</span><span class="p">(</span>
    <span class="n">populations</span><span class="o">=</span><span class="p">[</span><span class="n">sheep_pop</span><span class="p">,</span> <span class="n">shepherd_pop</span><span class="p">],</span>
    <span class="n">environment</span><span class="o">=</span><span class="n">environment</span><span class="p">,</span>
    <span class="n">controllers</span><span class="o">=</span><span class="p">[</span><span class="n">shepherding_controller</span><span class="p">],</span>
    <span class="n">loggers</span><span class="o">=</span><span class="p">[</span><span class="n">data_logger</span><span class="p">],</span>
    <span class="n">dt</span><span class="o">=</span><span class="mf">0.02</span>
<span class="p">)</span>

<span class="c1"># Simulation with automatic logging</span>
<span class="n">simulator</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
    <span class="n">total_steps</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span>
    <span class="n">log_interval</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">render_interval</span><span class="o">=</span><span class="mi">50</span>
<span class="p">)</span>

<span class="c1"># Access logged data</span>
<span class="n">logged_data</span> <span class="o">=</span> <span class="n">simulator</span><span class="o">.</span><span class="n">get_log_data</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="reinforcement-learning-environment">
<h3>Reinforcement Learning Environment<a class="headerlink" href="#reinforcement-learning-environment" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">swarmsim.Simulators</span><span class="w"> </span><span class="kn">import</span> <span class="n">GymSimulator</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">swarmsim.Populations</span><span class="w"> </span><span class="kn">import</span> <span class="n">DoubleIntegrators</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">swarmsim.Environments</span><span class="w"> </span><span class="kn">import</span> <span class="n">ShepherdingEnvironment</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">gymnasium</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">gym</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">gymnasium</span><span class="w"> </span><span class="kn">import</span> <span class="n">spaces</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># Define action and observation spaces</span>
<span class="n">n_agents</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">action_space</span> <span class="o">=</span> <span class="n">spaces</span><span class="o">.</span><span class="n">Box</span><span class="p">(</span>
    <span class="n">low</span><span class="o">=-</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">n_agents</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
    <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span>
<span class="p">)</span>

<span class="n">observation_space</span> <span class="o">=</span> <span class="n">spaces</span><span class="o">.</span><span class="n">Box</span><span class="p">(</span>
    <span class="n">low</span><span class="o">=-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span>
    <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">n_agents</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>  <span class="c1"># x, y, vx, vy per agent</span>
    <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span>
<span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">reward_function</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">action</span><span class="p">,</span> <span class="n">next_state</span><span class="p">):</span>
    <span class="c1"># Custom reward based on formation maintenance</span>
    <span class="n">positions</span> <span class="o">=</span> <span class="n">next_state</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">center</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">positions</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">distances</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">positions</span> <span class="o">-</span> <span class="n">center</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">formation_reward</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">distances</span><span class="p">)</span>  <span class="c1"># Reward tight formation</span>
    <span class="k">return</span> <span class="n">formation_reward</span>

<span class="c1"># Create RL environment</span>
<span class="n">gym_simulator</span> <span class="o">=</span> <span class="n">GymSimulator</span><span class="p">(</span>
    <span class="n">populations</span><span class="o">=</span><span class="p">[</span><span class="n">DoubleIntegrators</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">n_agents</span><span class="p">,</span> <span class="n">x_dim</span><span class="o">=</span><span class="mi">2</span><span class="p">)],</span>
    <span class="n">environment</span><span class="o">=</span><span class="n">ShepherdingEnvironment</span><span class="p">(),</span>
    <span class="n">action_space</span><span class="o">=</span><span class="n">action_space</span><span class="p">,</span>
    <span class="n">observation_space</span><span class="o">=</span><span class="n">observation_space</span><span class="p">,</span>
    <span class="n">reward_function</span><span class="o">=</span><span class="n">reward_function</span><span class="p">,</span>
    <span class="n">max_episode_steps</span><span class="o">=</span><span class="mi">1000</span>
<span class="p">)</span>

<span class="c1"># Use with RL algorithms</span>
<span class="n">obs</span> <span class="o">=</span> <span class="n">gym_simulator</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
<span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">):</span>
    <span class="n">action</span> <span class="o">=</span> <span class="n">policy</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">obs</span><span class="p">)</span>  <span class="c1"># Your RL policy</span>
    <span class="n">obs</span><span class="p">,</span> <span class="n">reward</span><span class="p">,</span> <span class="n">done</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">gym_simulator</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">done</span><span class="p">:</span>
        <span class="n">obs</span> <span class="o">=</span> <span class="n">gym_simulator</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
</pre></div>
</div>
</section>
</section>
<section id="performance-optimization">
<h2>Performance Optimization<a class="headerlink" href="#performance-optimization" title="Link to this heading"></a></h2>
<p>Simulators are optimized for various performance scenarios:</p>
<ul class="simple">
<li><p><strong>Large Populations</strong>: Efficient algorithms that scale well with agent count</p></li>
<li><p><strong>Long Simulations</strong>: Memory management for extended simulation runs</p></li>
<li><p><strong>Real-time Applications</strong>: Low-latency stepping for interactive use</p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="swarmsim.Renderers.html" class="btn btn-neutral float-left" title="Visualization &amp; Rendering" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="swarmsim.Utils.html" class="btn btn-neutral float-right" title="Utilities Package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, SINCRO Group - Stefano Covone, Italo Napolitano, Davide Salzano.
      <span class="lastupdated">Last updated on Aug 27, 2025.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>