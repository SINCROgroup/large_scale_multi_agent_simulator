

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>swarmsim.Utils.params_utils &mdash; IntelliSwarm 1.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css?v=e59714d7" />

  
      <script src="../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../_static/documentation_options.js?v=8d563738"></script>
      <script src="../../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #2980B9" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            IntelliSwarm
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../installation.html">Installation Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../installation.html#requirements">Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../installation.html#core-dependencies">Core Dependencies</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../installation.html#optional-dependencies">Optional Dependencies</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../installation.html#installation-methods">Installation Methods</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../installation.html#method-1-install-from-source-recommended">Method 1: Install from Source (Recommended)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../installation.html#verification">Verification</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../installation.html#next-steps">Next Steps</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../installation.html#support">Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../installation.html#contributing">Contributing</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../quickstart.html">Quick Start Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../quickstart.html#your-first-simulation">Your First Simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../quickstart.html#core-concepts">Core Concepts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../quickstart.html#configuration-files">Configuration Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../quickstart.html#running-simulations-using-gui">Running Simulations using GUI</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../quickstart.html#next-steps">Next Steps</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../swarmsim.html">IntelliSwarm Package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../swarmsim.html#swarmsim-a-large-scale-multi-agent-simulator">SwarmSim: A Large-Scale Multi-Agent Simulator</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../swarmsim.html#key-features">Key Features</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../swarmsim.html#main-components">Main Components</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../swarmsim.html#package-overview">Package Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../swarmsim.html#architecture">Architecture</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../swarmsim.html#subpackages">Subpackages</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../swarmsim.Controllers.html">Controllers Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../swarmsim.Controllers.html#controllers-module">Controllers Module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../swarmsim.Controllers.html#package-overview">Package Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../swarmsim.Controllers.html#core-modules">Core Modules</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../swarmsim.Controllers.html#usage-examples">Usage Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../swarmsim.Controllers.html#control-architecture">Control Architecture</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../swarmsim.Controllers.html#performance-considerations">Performance Considerations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../swarmsim.Controllers.html#best-practices">Best Practices</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../swarmsim.Environments.html">Environments Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../swarmsim.Environments.html#environments-module">Environments Module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../swarmsim.Environments.html#swarmsim.Environments.Environment"><code class="docutils literal notranslate"><span class="pre">Environment</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../swarmsim.Environments.html#swarmsim.Environments.EmptyEnvironment"><code class="docutils literal notranslate"><span class="pre">EmptyEnvironment</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../swarmsim.Environments.html#swarmsim.Environments.ShepherdingEnvironment"><code class="docutils literal notranslate"><span class="pre">ShepherdingEnvironment</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../swarmsim.Environments.html#package-overview">Package Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../swarmsim.Environments.html#core-modules">Core Modules</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../swarmsim.Environments.html#usage-examples">Usage Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../swarmsim.Environments.html#best-practices">Best Practices</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../swarmsim.Environments.html#id1">Shepherding Environment</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../swarmsim.Integrators.html">Numerical Integrators</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../swarmsim.Integrators.html#overview">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../swarmsim.Integrators.html#key-features">Key Features</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../swarmsim.Integrators.html#module-swarmsim.Integrators">Module Reference</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../swarmsim.Integrators.html#integrators-module">Integrators Module</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../swarmsim.Integrators.html#base-integrator-interface">Base Integrator Interface</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../swarmsim.Integrators.html#swarmsim.Integrators.base_integrator.Integrator"><code class="docutils literal notranslate"><span class="pre">Integrator</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../swarmsim.Integrators.html#euler-maruyama-integrator">Euler-Maruyama Integrator</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../swarmsim.Integrators.html#swarmsim.Integrators.euler_maruyama.EulerMaruyamaIntegrator"><code class="docutils literal notranslate"><span class="pre">EulerMaruyamaIntegrator</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../swarmsim.Integrators.html#troubleshooting">Troubleshooting</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../swarmsim.Integrators.html#common-integration-issues">Common Integration Issues</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../swarmsim.Integrators.html#see-also">See Also</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../swarmsim.Interactions.html">Interactions Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../swarmsim.Interactions.html#interactions-module">Interactions Module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../swarmsim.Interactions.html#swarmsim.Interactions.Interaction"><code class="docutils literal notranslate"><span class="pre">Interaction</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../swarmsim.Interactions.html#swarmsim.Interactions.HarmonicRepulsion"><code class="docutils literal notranslate"><span class="pre">HarmonicRepulsion</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../swarmsim.Interactions.html#swarmsim.Interactions.PowerLawRepulsion"><code class="docutils literal notranslate"><span class="pre">PowerLawRepulsion</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../swarmsim.Interactions.html#swarmsim.Interactions.PowerLawInteraction"><code class="docutils literal notranslate"><span class="pre">PowerLawInteraction</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../swarmsim.Interactions.html#swarmsim.Interactions.LennardJones"><code class="docutils literal notranslate"><span class="pre">LennardJones</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../swarmsim.Interactions.html#package-overview">Package Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../swarmsim.Interactions.html#core-modules">Core Modules</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../swarmsim.Interactions.html#best-practices">Best Practices</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../swarmsim.Loggers.html">Data Loggers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../swarmsim.Loggers.html#overview">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../swarmsim.Loggers.html#key-features">Key Features</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../swarmsim.Loggers.html#module-swarmsim.Loggers">Module Reference</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../swarmsim.Loggers.html#base-logger-interface">Base Logger Interface</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../swarmsim.Loggers.html#swarmsim.Loggers.base_logger.BaseLogger"><code class="docutils literal notranslate"><span class="pre">BaseLogger</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../swarmsim.Loggers.html#standard-logger-implementation">Standard Logger Implementation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../swarmsim.Loggers.html#swarmsim.Loggers.logger.Logger"><code class="docutils literal notranslate"><span class="pre">Logger</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../swarmsim.Loggers.html#features">Features</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../swarmsim.Loggers.html#position-logger">Position Logger</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../swarmsim.Loggers.html#swarmsim.Loggers.position_logger.PositionLogger"><code class="docutils literal notranslate"><span class="pre">PositionLogger</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../swarmsim.Loggers.html#capabilities">Capabilities</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../swarmsim.Loggers.html#shepherding-logger">Shepherding Logger</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../swarmsim.Loggers.html#swarmsim.Loggers.shepherding_logger.ShepherdingLogger"><code class="docutils literal notranslate"><span class="pre">ShepherdingLogger</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../swarmsim.Loggers.html#specialized-features">Specialized Features</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../swarmsim.Loggers.html#see-also">See Also</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../swarmsim.Populations.html">Populations Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../swarmsim.Populations.html#population-module">Population Module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../swarmsim.Populations.html#package-overview">Package Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../swarmsim.Populations.html#core-modules">Core Modules</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../swarmsim.Populations.html#usage-examples">Usage Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../swarmsim.Populations.html#performance-optimization">Performance Optimization</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../swarmsim.Populations.html#model-selection-guide">Model Selection Guide</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../swarmsim.Populations.html#best-practices">Best Practices</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../swarmsim.Renderers.html">Visualization &amp; Rendering</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../swarmsim.Renderers.html#overview">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../swarmsim.Renderers.html#key-features">Key Features</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../swarmsim.Renderers.html#module-swarmsim.Renderers">Module Reference</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../swarmsim.Renderers.html#swarmsim-renderers">swarmsim.Renderers</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../swarmsim.Renderers.html#base-renderer-interface">Base Renderer Interface</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../swarmsim.Renderers.html#swarmsim.Renderers.renderer.Renderer"><code class="docutils literal notranslate"><span class="pre">Renderer</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../swarmsim.Renderers.html#standard-base-renderer">Standard Base Renderer</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../swarmsim.Renderers.html#swarmsim.Renderers.base_renderer.BaseRenderer"><code class="docutils literal notranslate"><span class="pre">BaseRenderer</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../swarmsim.Renderers.html#biological-systems-renderer">Biological Systems Renderer</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../swarmsim.Renderers.html#swarmsim.Renderers.bio_renderer.BioRenderer"><code class="docutils literal notranslate"><span class="pre">BioRenderer</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../swarmsim.Renderers.html#shepherding-renderer">Shepherding Renderer</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../swarmsim.Renderers.html#swarmsim.Renderers.shepherding_renderer.ShepherdingRenderer"><code class="docutils literal notranslate"><span class="pre">ShepherdingRenderer</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../swarmsim.Renderers.html#see-also">See Also</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../swarmsim.Simulators.html">Simulators Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../swarmsim.Simulators.html#swarmsim-simulators">swarmsim.Simulators</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../swarmsim.Simulators.html#package-overview">Package Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../swarmsim.Simulators.html#core-modules">Core Modules</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../swarmsim.Simulators.html#usage-examples">Usage Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../swarmsim.Simulators.html#performance-optimization">Performance Optimization</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../swarmsim.Utils.html">Utilities Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../swarmsim.Utils.html#swarmsim-utils">swarmsim.Utils</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../swarmsim.Utils.html#package-overview">Package Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../swarmsim.Utils.html#core-modules">Core Modules</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../swarmsim.Utils.html#supporting-modules">Supporting Modules</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #2980B9" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">IntelliSwarm</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">Module code</a></li>
      <li class="breadcrumb-item active">swarmsim.Utils.params_utils</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for swarmsim.Utils.params_utils</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>


<div class="viewcode-block" id="get_parameters">
<a class="viewcode-back" href="../../../swarmsim.Utils.html#swarmsim.Utils.params_utils.get_parameters">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">get_parameters</span><span class="p">(</span><span class="n">params_config</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">params_shapes</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">],</span> <span class="n">num_samples</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Load or generate parameters for population initialization with flexible configuration.</span>

<span class="sd">    This function serves as the main entry point for parameter generation in the swarmsim</span>
<span class="sd">    framework. It supports both file-based parameter loading and procedural parameter</span>
<span class="sd">    generation using statistical distributions, enabling flexible population initialization</span>
<span class="sd">    for multi-agent simulations.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    params_config : dict</span>
<span class="sd">        Configuration dictionary specifying parameter loading/generation method.</span>
<span class="sd">        Must contain &#39;mode&#39; key with value &#39;file&#39; or &#39;generate&#39;, plus corresponding</span>
<span class="sd">        configuration section.</span>
<span class="sd">    params_shapes : dict[str, tuple]</span>
<span class="sd">        Dictionary mapping parameter names to their expected shapes per agent.</span>
<span class="sd">        Used for validation and reshaping operations.</span>
<span class="sd">    num_samples : int</span>
<span class="sd">        Number of agents/samples to generate parameters for.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    dict[str, np.ndarray]</span>
<span class="sd">        Dictionary mapping parameter names to NumPy arrays of shape (num_samples, *shape)</span>
<span class="sd">        where shape corresponds to the parameter&#39;s expected dimensions.</span>

<span class="sd">    Configuration Structure</span>
<span class="sd">    ----------------------</span>
<span class="sd">    File Mode:</span>
<span class="sd">        .. code-block:: yaml</span>

<span class="sd">            mode: &quot;file&quot;</span>
<span class="sd">            file:</span>
<span class="sd">              file_path: &quot;path/to/parameters.csv&quot;  # or .npz</span>

<span class="sd">    Generate Mode:</span>
<span class="sd">        .. code-block:: yaml</span>

<span class="sd">            mode: &quot;generate&quot;</span>
<span class="sd">            generate:</span>
<span class="sd">              parameter_name:</span>
<span class="sd">                sampler: &quot;normal&quot;  # Distribution type</span>
<span class="sd">                args:</span>
<span class="sd">                  loc: 0.0         # Distribution parameters</span>
<span class="sd">                  scale: 1.0</span>
<span class="sd">                shape: [3]         # Parameter shape per agent</span>
<span class="sd">                homogeneous: false # Same value for all agents</span>

<span class="sd">    </span>
<span class="sd">    Error Handling</span>
<span class="sd">    --------------</span>
<span class="sd">    - **FileNotFoundError**: Raised when specified parameter file doesn&#39;t exist</span>
<span class="sd">    - **KeyError**: Raised when expected parameters are missing from loaded data</span>
<span class="sd">    - **ValueError**: Raised for invalid parameter shapes or configurations</span>
<span class="sd">    - **RuntimeError**: Raised for invalid mode specifications</span>

<span class="sd">    Applications</span>
<span class="sd">    ------------</span>
<span class="sd">    - **Population Initialization**: Set agent properties for simulation start</span>
<span class="sd">    - **Parameter Studies**: Generate parameter sets for sensitivity analysis</span>
<span class="sd">    - **Multi-species Systems**: Handle heterogeneous agent populations</span>
<span class="sd">    - **Reproducible Research**: Load exact parameter sets from files</span>

<span class="sd">    </span>
<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    _load_parameters : File-based parameter loading implementation</span>
<span class="sd">    _generate_parameters : Statistical parameter generation implementation</span>
<span class="sd">    _reshape_parameter : Parameter reshaping utilities</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">mode</span> <span class="o">=</span> <span class="n">params_config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;mode&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;file&quot;</span><span class="p">:</span>
        <span class="n">settings</span> <span class="o">=</span> <span class="n">params_config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;file&quot;</span><span class="p">)</span>
        <span class="n">params</span> <span class="o">=</span> <span class="n">_load_parameters</span><span class="p">(</span><span class="n">settings</span><span class="p">,</span> <span class="n">num_samples</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;generate&quot;</span><span class="p">:</span>
        <span class="n">settings</span> <span class="o">=</span> <span class="n">params_config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;generate&quot;</span><span class="p">)</span>
        <span class="n">params</span> <span class="o">=</span> <span class="n">_generate_parameters</span><span class="p">(</span><span class="n">settings</span><span class="p">,</span> <span class="n">num_samples</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Invalid parameter mode. Check the YAML config file.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">params_shapes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;params_shapes must be defined before initializing parameters.&quot;</span><span class="p">)</span>

    <span class="n">missing</span> <span class="o">=</span> <span class="p">[</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">params_shapes</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">params</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">missing</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Missing parameter(s) in params: </span><span class="si">{</span><span class="n">missing</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">{</span>
        <span class="n">key</span><span class="p">:</span> <span class="n">_reshape_parameter</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">shape</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">shape</span> <span class="ow">in</span> <span class="n">params_shapes</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
    <span class="p">}</span></div>



<span class="k">def</span><span class="w"> </span><span class="nf">_load_parameters</span><span class="p">(</span><span class="n">params_config</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">num_samples</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Load parameters from CSV or NPZ files with automatic population matching.</span>

<span class="sd">    This helper function handles file-based parameter loading with intelligent</span>
<span class="sd">    population size matching. It automatically repeats or truncates parameter</span>
<span class="sd">    data to match the required number of samples, ensuring consistent population</span>
<span class="sd">    initialization regardless of file size.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    params_config : dict</span>
<span class="sd">        Configuration dictionary containing file loading settings.</span>
<span class="sd">        Must include &#39;file_path&#39; key pointing to CSV or NPZ file.</span>
<span class="sd">    num_samples : int</span>
<span class="sd">        Target number of parameter sets to generate. File data will be</span>
<span class="sd">        adjusted to match this count.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    dict[str, np.ndarray]</span>
<span class="sd">        Dictionary mapping parameter names to NumPy arrays, each with</span>
<span class="sd">        num_samples entries along the first dimension.</span>

<span class="sd">    File Format Support</span>
<span class="sd">    -------------------</span>
<span class="sd">    **CSV Files**:</span>
<span class="sd">        - Column headers become parameter names</span>
<span class="sd">        - Each row represents one agent&#39;s parameters</span>
<span class="sd">        - Supports all numeric data types</span>
<span class="sd">        - Missing values handled automatically</span>

<span class="sd">    **NPZ Files**:</span>
<span class="sd">        - Each array key becomes a parameter name</span>
<span class="sd">        - First dimension must match across all parameters</span>
<span class="sd">        - Preserves exact numerical precision</span>
<span class="sd">        - Supports complex data structures</span>

<span class="sd">    Population Matching</span>
<span class="sd">    -------------------</span>
<span class="sd">    **Too Few Samples**: Randomly repeats existing rows to reach target count</span>
<span class="sd">    **Too Many Samples**: Randomly selects subset to match target count</span>
<span class="sd">    **Exact Match**: Uses data as-is without modification</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    Loading CSV parameter file:</span>

<span class="sd">    .. code-block:: python</span>

<span class="sd">        # CSV file structure (example: euglena_params.csv):</span>
<span class="sd">        # mass,diameter,max_speed,light_sensitivity</span>
<span class="sd">        # 1.2,0.05,2.1,0.8</span>
<span class="sd">        # 1.1,0.048,2.3,0.75</span>
<span class="sd">        # 1.3,0.052,1.9,0.85</span>

<span class="sd">        config = {</span>
<span class="sd">            &#39;file_path&#39;: &#39;Configuration/Config_data/euglena_params.csv&#39;</span>
<span class="sd">        }</span>
<span class="sd">        </span>
<span class="sd">        params = _load_parameters(config, num_samples=100)</span>
<span class="sd">        </span>
<span class="sd">        # Returns:</span>
<span class="sd">        # {</span>
<span class="sd">        #     &#39;mass&#39;: array([1.2, 1.1, 1.3, 1.2, ...]),      # 100 samples</span>
<span class="sd">        #     &#39;diameter&#39;: array([0.05, 0.048, 0.052, ...]),   # 100 samples</span>
<span class="sd">        #     &#39;max_speed&#39;: array([2.1, 2.3, 1.9, ...]),       # 100 samples</span>
<span class="sd">        #     &#39;light_sensitivity&#39;: array([0.8, 0.75, 0.85, ...]) # 100 samples</span>
<span class="sd">        # }</span>

<span class="sd">    </span>
<span class="sd">    Error Handling</span>
<span class="sd">    --------------</span>
<span class="sd">    - **FileNotFoundError**: When specified file doesn&#39;t exist</span>
<span class="sd">    - **ValueError**: For unsupported file formats or invalid data</span>
<span class="sd">    - **KeyError**: When expected parameter columns/arrays are missing</span>
<span class="sd">    - **MemoryError**: For extremely large files (use chunked loading)</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    - Preserves parameter names exactly as they appear in files</span>
<span class="sd">    - Maintains data types from original files when possible</span>
<span class="sd">    - Logs warnings when adjusting population size</span>
<span class="sd">    - Supports both absolute and relative file paths</span>
<span class="sd">    - Thread-safe for concurrent parameter loading</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">file_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">params_config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;file_path&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">))</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">file_path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
        <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Parameters file &#39;</span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">&#39; not found.&quot;</span><span class="p">)</span>

    <span class="c1"># Load from CSV file using pandas for convenience</span>
    <span class="k">if</span> <span class="n">file_path</span><span class="o">.</span><span class="n">suffix</span> <span class="o">==</span> <span class="s2">&quot;.csv&quot;</span><span class="p">:</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
        <span class="n">params_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">col</span><span class="p">:</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">}</span>

    <span class="c1"># Load from NPZ file</span>
    <span class="k">elif</span> <span class="n">file_path</span><span class="o">.</span><span class="n">suffix</span> <span class="o">==</span> <span class="s2">&quot;.npz&quot;</span><span class="p">:</span>
        <span class="n">npz_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
        <span class="n">params_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">key</span><span class="p">:</span> <span class="n">npz_data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">npz_data</span><span class="o">.</span><span class="n">files</span><span class="p">}</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unsupported file type &#39;</span><span class="si">{</span><span class="n">file_path</span><span class="o">.</span><span class="n">suffix</span><span class="si">}</span><span class="s2">&#39;. Only &#39;.csv&#39; and &#39;.npz&#39; are supported.&quot;</span><span class="p">)</span>

    <span class="n">current_num_samples</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">params_dict</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># Repeat rows if not enough</span>
    <span class="k">if</span> <span class="n">current_num_samples</span> <span class="o">&lt;</span> <span class="n">num_samples</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Parameters file has fewer rows than N; repeating some rows to match agent count.&quot;</span><span class="p">)</span>
        <span class="n">repeat_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">current_num_samples</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">num_samples</span> <span class="o">-</span> <span class="n">current_num_samples</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">params_dict</span><span class="p">:</span>
            <span class="n">params_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">params_dict</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">params_dict</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="n">repeat_indices</span><span class="p">]])</span>

    <span class="c1"># Truncate if too many rows</span>
    <span class="k">elif</span> <span class="n">current_num_samples</span> <span class="o">&gt;</span> <span class="n">num_samples</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Parameters file has more rows than N; truncating to match agent count.&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">params_dict</span><span class="p">:</span>
            <span class="n">params_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">params_dict</span><span class="p">[</span><span class="n">key</span><span class="p">][:</span><span class="n">num_samples</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">params_dict</span>


<span class="k">def</span><span class="w"> </span><span class="nf">_generate_parameters</span><span class="p">(</span><span class="n">params_config</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">num_samples</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generate parameters using statistical distributions and configuration.</span>

<span class="sd">    This function creates parameter sets using a comprehensive collection of</span>
<span class="sd">    statistical distributions from NumPy&#39;s random module. It supports both</span>
<span class="sd">    homogeneous (same value for all agents) and heterogeneous (different</span>
<span class="sd">    values per agent) parameter generation with flexible shape control.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    params_config : dict</span>
<span class="sd">        Configuration dictionary specifying parameters to generate.</span>
<span class="sd">        Each key represents a parameter name with associated generation settings.</span>
<span class="sd">    num_samples : int</span>
<span class="sd">        Number of parameter sets (agents) to generate.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    dict[str, np.ndarray]</span>
<span class="sd">        Dictionary mapping parameter names to generated NumPy arrays.</span>
<span class="sd">        Arrays have shape (num_samples, *parameter_shape).</span>

<span class="sd">    Supported Distributions</span>
<span class="sd">    -----------------------</span>
<span class="sd">    **Continuous Distributions**:</span>
<span class="sd">        - uniform, normal, exponential, gamma, beta, lognormal</span>
<span class="sd">        - laplace, logistic, gumbel, rayleigh, weibull, pareto</span>
<span class="sd">        - standard_normal, standard_exponential, standard_gamma</span>
<span class="sd">        - triangular, vonmises, wald, power, chisquare, f</span>
<span class="sd">        - noncentral_chisquare, noncentral_f, standard_cauchy, standard_t</span>

<span class="sd">    **Discrete Distributions**:</span>
<span class="sd">        - poisson, binomial, negative_binomial, geometric</span>
<span class="sd">        - hypergeometric, logseries, zipf</span>

<span class="sd">    **Multivariate Distributions**:</span>
<span class="sd">        - multivariate_normal, multinomial</span>

<span class="sd">    Parameter Configuration</span>
<span class="sd">    ----------------------</span>
<span class="sd">    Each parameter can be configured as:</span>

<span class="sd">    1. **Constant Value**: Simple numeric value or array</span>
<span class="sd">    2. **Distribution Sampling**: Dictionary with sampler configuration</span>
<span class="sd">    3. **Homogeneous Sampling**: Same random value for all agents</span>
<span class="sd">    4. **Heterogeneous Sampling**: Different random values per agent</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    Basic parameter generation:</span>

<span class="sd">    .. code-block:: python</span>

<span class="sd">        config = {</span>
<span class="sd">            # Constant parameters</span>
<span class="sd">            &#39;species_id&#39;: 1,                    # Same for all agents</span>
<span class="sd">            &#39;max_neighbors&#39;: 10,                # Same for all agents</span>
<span class="sd">            </span>
<span class="sd">            # Scalar random parameters</span>
<span class="sd">            &#39;mass&#39;: {</span>
<span class="sd">                &#39;sampler&#39;: &#39;normal&#39;,</span>
<span class="sd">                &#39;args&#39;: {&#39;loc&#39;: 1.0, &#39;scale&#39;: 0.1}</span>
<span class="sd">            },</span>
<span class="sd">            </span>
<span class="sd">            # Vector random parameters  </span>
<span class="sd">            &#39;initial_position&#39;: {</span>
<span class="sd">                &#39;sampler&#39;: &#39;uniform&#39;,</span>
<span class="sd">                &#39;args&#39;: {&#39;low&#39;: -5.0, &#39;high&#39;: 5.0},</span>
<span class="sd">                &#39;shape&#39;: [3]  # 3D position</span>
<span class="sd">            },</span>
<span class="sd">            </span>
<span class="sd">            # Homogeneous parameters (same random value for all)</span>
<span class="sd">            &#39;environment_temperature&#39;: {</span>
<span class="sd">                &#39;sampler&#39;: &#39;normal&#39;,</span>
<span class="sd">                &#39;args&#39;: {&#39;loc&#39;: 20.0, &#39;scale&#39;: 2.0},</span>
<span class="sd">                &#39;homogeneous&#39;: True</span>
<span class="sd">            }</span>
<span class="sd">        }</span>
<span class="sd">        </span>
<span class="sd">        params = _generate_parameters(config, num_samples=100)</span>

<span class="sd">    </span>
<span class="sd">    Applications</span>
<span class="sd">    ------------</span>
<span class="sd">    - **Agent Initialization**: Set diverse agent properties for realistic populations</span>
<span class="sd">    - **Parameter Studies**: Generate parameter sets for sensitivity analysis</span>
<span class="sd">    - **Monte Carlo Simulation**: Generate random inputs for statistical analysis</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    numpy.random : Complete documentation of available distributions</span>
<span class="sd">    _reshape_parameter : Function for parameter shape manipulation</span>
<span class="sd">    get_parameters : Main parameter loading/generation interface</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">params_dict</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="n">sampler_mapping</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;uniform&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">,</span>
        <span class="s2">&quot;normal&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">,</span>
        <span class="s2">&quot;poisson&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">poisson</span><span class="p">,</span>
        <span class="s2">&quot;exponential&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">exponential</span><span class="p">,</span>
        <span class="s2">&quot;binomial&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">binomial</span><span class="p">,</span>
        <span class="s2">&quot;gamma&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">gamma</span><span class="p">,</span>
        <span class="s2">&quot;beta&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">beta</span><span class="p">,</span>
        <span class="s2">&quot;chisquare&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">chisquare</span><span class="p">,</span>
        <span class="s2">&quot;f&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">f</span><span class="p">,</span>
        <span class="s2">&quot;geometric&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">geometric</span><span class="p">,</span>
        <span class="s2">&quot;gumbel&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">gumbel</span><span class="p">,</span>
        <span class="s2">&quot;hypergeometric&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">hypergeometric</span><span class="p">,</span>
        <span class="s2">&quot;laplace&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">laplace</span><span class="p">,</span>
        <span class="s2">&quot;logistic&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">logistic</span><span class="p">,</span>
        <span class="s2">&quot;lognormal&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">lognormal</span><span class="p">,</span>
        <span class="s2">&quot;logseries&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">logseries</span><span class="p">,</span>
        <span class="s2">&quot;multinomial&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">multinomial</span><span class="p">,</span>
        <span class="s2">&quot;multivariate_normal&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">multivariate_normal</span><span class="p">,</span>
        <span class="s2">&quot;negative_binomial&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">negative_binomial</span><span class="p">,</span>
        <span class="s2">&quot;noncentral_chisquare&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">noncentral_chisquare</span><span class="p">,</span>
        <span class="s2">&quot;noncentral_f&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">noncentral_f</span><span class="p">,</span>
        <span class="s2">&quot;pareto&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">pareto</span><span class="p">,</span>
        <span class="s2">&quot;power&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">power</span><span class="p">,</span>
        <span class="s2">&quot;rayleigh&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rayleigh</span><span class="p">,</span>
        <span class="s2">&quot;standard_cauchy&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">standard_cauchy</span><span class="p">,</span>
        <span class="s2">&quot;standard_exponential&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">standard_exponential</span><span class="p">,</span>
        <span class="s2">&quot;standard_gamma&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">standard_gamma</span><span class="p">,</span>
        <span class="s2">&quot;standard_normal&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">,</span>
        <span class="s2">&quot;standard_t&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">standard_t</span><span class="p">,</span>
        <span class="s2">&quot;triangular&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">triangular</span><span class="p">,</span>
        <span class="s2">&quot;vonmises&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">vonmises</span><span class="p">,</span>
        <span class="s2">&quot;wald&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">wald</span><span class="p">,</span>
        <span class="s2">&quot;weibull&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">weibull</span><span class="p">,</span>
        <span class="s2">&quot;zipf&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">zipf</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="k">for</span> <span class="n">par_name</span><span class="p">,</span> <span class="n">settings</span> <span class="ow">in</span> <span class="n">params_config</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">settings</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="n">constant_value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">settings</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">settings</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">))</span> <span class="k">else</span> <span class="n">settings</span>
            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isscalar</span><span class="p">(</span><span class="n">constant_value</span><span class="p">):</span>
                <span class="n">params_dict</span><span class="p">[</span><span class="n">par_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">num_samples</span><span class="p">,</span> <span class="n">constant_value</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">stacked_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">constant_value</span><span class="p">]</span> <span class="o">*</span> <span class="n">num_samples</span><span class="p">)</span>
                <span class="n">params_dict</span><span class="p">[</span><span class="n">par_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">stacked_array</span>
            <span class="k">continue</span>

        <span class="n">sampler_key</span> <span class="o">=</span> <span class="n">settings</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;sampler&quot;</span><span class="p">,</span> <span class="s2">&quot;uniform&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">sampler_key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">sampler_mapping</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unsupported sampler: </span><span class="si">{</span><span class="n">sampler_key</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">sampler</span> <span class="o">=</span> <span class="n">sampler_mapping</span><span class="p">[</span><span class="n">sampler_key</span><span class="p">]</span>

        <span class="n">positional_args</span> <span class="o">=</span> <span class="n">settings</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;positional_args&quot;</span><span class="p">)</span>
        <span class="n">args</span> <span class="o">=</span> <span class="n">settings</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;args&quot;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="n">shape</span> <span class="o">=</span> <span class="n">settings</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;shape&quot;</span><span class="p">,</span> <span class="p">[])</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">shape</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">shape</span><span class="p">)</span>

        <span class="n">is_homogeneous</span> <span class="o">=</span> <span class="n">settings</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;homogeneous&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">is_homogeneous</span><span class="p">:</span>
            <span class="n">args</span><span class="p">[</span><span class="s2">&quot;size&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">shape</span> <span class="k">if</span> <span class="n">shape</span> <span class="k">else</span> <span class="p">()</span>
            <span class="k">if</span> <span class="n">positional_args</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">single_value</span> <span class="o">=</span> <span class="n">sampler</span><span class="p">(</span><span class="o">*</span><span class="n">positional_args</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">single_value</span> <span class="o">=</span> <span class="n">sampler</span><span class="p">(</span><span class="o">**</span><span class="n">args</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">shape</span><span class="p">:</span>
                <span class="n">stacked_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">single_value</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_samples</span><span class="p">)])</span>
                <span class="n">params_dict</span><span class="p">[</span><span class="n">par_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">stacked_array</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">params_dict</span><span class="p">[</span><span class="n">par_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">num_samples</span><span class="p">,</span> <span class="n">single_value</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">args</span><span class="p">[</span><span class="s2">&quot;size&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">num_samples</span><span class="p">,)</span> <span class="o">+</span> <span class="n">shape</span> <span class="k">if</span> <span class="n">shape</span> <span class="k">else</span> <span class="n">num_samples</span>
            <span class="k">if</span> <span class="n">positional_args</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">values</span> <span class="o">=</span> <span class="n">sampler</span><span class="p">(</span><span class="o">*</span><span class="n">positional_args</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">values</span> <span class="o">=</span> <span class="n">sampler</span><span class="p">(</span><span class="o">**</span><span class="n">args</span><span class="p">)</span>
            <span class="n">params_dict</span><span class="p">[</span><span class="n">par_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">params_dict</span>


<span class="k">def</span><span class="w"> </span><span class="nf">_reshape_parameter</span><span class="p">(</span><span class="n">param_array</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">shape</span><span class="p">:</span> <span class="nb">tuple</span> <span class="o">=</span> <span class="p">())</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Reshape parameter arrays to consistent multi-agent format with automatic broadcasting.</span>

<span class="sd">    This function standardizes parameter arrays to have consistent dimensions across</span>
<span class="sd">    all agents, handling scalar-to-tensor broadcasting and special cases like</span>
<span class="sd">    diagonal matrix creation. It ensures all parameters have the format</span>
<span class="sd">    (num_agents, *parameter_shape) for uniform agent property access.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    param_array : np.ndarray</span>
<span class="sd">        Input parameter array where the first dimension corresponds to agents.</span>
<span class="sd">        Can contain scalars, vectors, or higher-dimensional structures per agent.</span>
<span class="sd">    shape : tuple of int, optional</span>
<span class="sd">        Target shape for each agent&#39;s parameter. Empty tuple () indicates scalar.</span>
<span class="sd">        Special handling for square matrices (diagonal initialization from scalars).</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    np.ndarray</span>
<span class="sd">        Reshaped array with dimensions (num_agents, *shape), where each agent&#39;s</span>
<span class="sd">        parameter conforms to the specified shape through broadcasting or </span>
<span class="sd">        transformation.</span>

<span class="sd">    Shape Transformation Rules</span>
<span class="sd">    -------------------------</span>
<span class="sd">    1. **Scalar to Scalar**: (N,)  (N,) - No change needed</span>
<span class="sd">    2. **Scalar to Vector**: (N,)  (N, d) - Broadcast scalar to vector</span>
<span class="sd">    3. **Scalar to Matrix**: (N,)  (N, d, d) - Create diagonal matrices</span>
<span class="sd">    4. **Vector to Vector**: (N, d)  (N, d) - Direct assignment</span>
<span class="sd">    5. **Matrix to Matrix**: (N, d, d)  (N, d, d) - Direct assignment</span>

<span class="sd">    Special Cases</span>
<span class="sd">    -------------</span>
<span class="sd">    **Diagonal Matrix Creation**: When target shape is (d, d) and input contains</span>
<span class="sd">    scalars, creates diagonal matrices with the scalar value on the diagonal.</span>

<span class="sd">    **Broadcasting**: When target shape has more dimensions than input, broadcasts</span>
<span class="sd">    the input to match the target shape while preserving agent dimension.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    Scalar to vector broadcasting:</span>

<span class="sd">    .. code-block:: python</span>

<span class="sd">        # Input: scalar values per agent</span>
<span class="sd">        masses = np.array([1.0, 1.2, 0.8, 1.1])  # Shape: (4,)</span>
<span class="sd">        </span>
<span class="sd">        # Reshape to 3D vectors (same mass in all dimensions)</span>
<span class="sd">        mass_vectors = _reshape_parameter(masses, shape=(3,))</span>
<span class="sd">        print(mass_vectors.shape)  # (4, 3)</span>
<span class="sd">        print(mass_vectors[0])     # [1.0, 1.0, 1.0]</span>

<span class="sd">    </span>
<span class="sd">    Error Handling</span>
<span class="sd">    --------------</span>
<span class="sd">    - **ValueError**: Raised when input array shapes are incompatible with target shape</span>
<span class="sd">    - **TypeError**: Raised when input is not a NumPy array</span>
<span class="sd">    - **IndexError**: Raised when accessing invalid array dimensions</span>

<span class="sd">    </span>
<span class="sd">    Applications</span>
<span class="sd">    ------------</span>
<span class="sd">    - **Agent Initialization**: Standardize diverse parameter formats</span>
<span class="sd">    - **Physical Properties**: Create mass/inertia matrices from scalar values</span>
<span class="sd">    - **Neural Networks**: Initialize weight matrices for agent brains</span>
<span class="sd">    - **Interaction Models**: Setup pairwise interaction parameter tensors</span>
<span class="sd">    - **Control Systems**: Create gain matrices from scalar tuning parameters</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    numpy.broadcast_to : NumPy broadcasting documentation</span>
<span class="sd">    numpy.zeros : Array initialization</span>
<span class="sd">    numpy.stack : Array stacking operations</span>
<span class="sd">    get_parameters : Main parameter processing interface</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">num_agents</span> <span class="o">=</span> <span class="n">param_array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isscalar</span><span class="p">(</span><span class="n">param_array</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
            <span class="n">d</span> <span class="o">=</span> <span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">num_agents</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">d</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">result_type</span><span class="p">(</span><span class="n">param_array</span><span class="p">))</span>
            <span class="n">diag_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
            <span class="n">result</span><span class="p">[:,</span> <span class="n">diag_indices</span><span class="p">,</span> <span class="n">diag_indices</span><span class="p">]</span> <span class="o">=</span> <span class="n">param_array</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">num_agents</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">reshaped</span> <span class="o">=</span> <span class="n">param_array</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">num_agents</span><span class="p">,)</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="p">,)</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">shape</span><span class="p">))</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">broadcast_to</span><span class="p">(</span><span class="n">reshaped</span><span class="p">,</span> <span class="p">(</span><span class="n">num_agents</span><span class="p">,)</span> <span class="o">+</span> <span class="n">shape</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">first_elem</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">param_array</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">first_elem</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="n">shape</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Expected shape </span><span class="si">{</span><span class="n">shape</span><span class="si">}</span><span class="s2"> but got </span><span class="si">{</span><span class="n">first_elem</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2"> for the first element.&quot;</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">param_array</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">result</span>



</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, SINCRO Group - Stefano Covone, Italo Napolitano, Davide Salzano.
      <span class="lastupdated">Last updated on Aug 27, 2025.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>